("undefined"===typeof $||!$)&&alert('You must include JQuery to run WizzyWig. Consider adding this to the top of your HTML:\n<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"><\/script>');$(document).ready(function(){new CssLoader(cssUrl());new WizzyWig(new Saver,WizzyWig.editableElements)});function cssUrl(){return $('script[src*="izzy"]').first().attr("src").replace(/\/javascript\/.*/g,"/css/wizzywig.css")};function CssLoader(a){var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a);document.getElementsByTagName("head")[0].appendChild(b)};function original(a){return a.originalEvent}function DragSource(a,b){b||(b={});a.attr("draggable","true");a.bind("dragstart",function(d){a.addClass("drag");b.dragStart&&b.dragStart(a,b.effect?b.effect:"move");original(d).dataTransfer.setData("text/html","monkeys")});a.bind("dragend",function(){a.removeClass("drag");b.dragEnd&&b.dragEnd(a)})}
function DropTarget(a,b){function d(c){a.addClass("dropTarget");b.dragOver&&b.dragOver(a);original(c).preventDefault();return!1}b||(b={});a.bind("dragenter",d);a.bind("dragover",d);a.bind("dragleave",function(){a.removeClass("dropTarget");b.dragLeave&&b.dragLeave(a)});a.bind("drop",function(c){b.drop&&b.drop(a);a.removeClass("dropTarget");original(c).stopPropagation();return!1})};function DragonController(a){function b(a,b){a.each(function(){new DragSource($(this),{dragStart:d,effect:b})})}function d(a,b){f=a;g=b}function c(b){var e=f;"copy"===g&&(e=f.clone(),e.addClass("clear").removeClass("left"),e.find(WizzyWig.editableElements).each(function(){a($(this))}),new DragSource(e,{dragStart:d}),new DropTarget(e,{drop:c}));b.before(e)}var f,g;this.makeMoveable=function(a){b(a,"move")};this.makeCopyable=function(a){b(a,"copy")};this.makeDropTarget=function(a){a.each(function(){new DropTarget($(this),
{drop:c})})}};function Inputter(a){var b=a.text(),d=new StyleCopier(a,["height","width"]);a.text("");a.append(Inputter.inputElement);var c=a.find("input");c.val(b);d.apply(c);c.blur(function(){var a=c.parent(),b=c.val();c.remove();a.html(b)});asPlain(c).focus()}Inputter.inputterFor=function(a){return function(){exists(a.find("input.inputter"))||new Inputter(a);return!0}};Inputter.inputElement='<input class="inputter" name="inputter" type="text" draggable="false" value="@original text@">';function Saver(){function a(){$("body").append('<div id="saverSandbox" class="hidden">'+$("body").html()+"</div>");$("#saverSandbox .editable").each(function(){$(this).removeClass("editable")});$("#wizzywigConsole").remove();$("#wizzywigConsole").remove();var a=$("#saverSandbox").html().replace(/ class=\"\"/g,"");$("#saverSandbox").remove();return a}var b=this;this.contents=function(){var b=a();return"<html><head>"+$("head").html()+"</head><body>"+b+"</body></html>"};this.save=function(a){var c="data:application/octet-stream,"+
encodeURIComponent(b.contents());window.open(c,"Save");a.stopPropagation();a.preventDefault();return!1}};function StyleCopier(a,b){var d=$.map(b,function(b){return{styleName:b,styleValue:a.css(b)}});this.apply=function(a){$.each(d,function(b,d){a.css(d.styleName,d.styleValue)})}};function asPlain(a){return a[0]}function exists(a){if("undefined"===typeof a)return!1;if(!a.size)throw"Not a JQuery object";return 0<a.size()}
function WizzyWig(a,b){function d(a){a.hasClass("editable")||(a.addClass("editable"),a.click(Inputter.inputterFor(a)))}$(b).each(function(){d($(this))});var c=new DragonController(d);c.makeMoveable($(WizzyWig.draggableElements));c.makeDropTarget($(WizzyWig.draggableElements));$("body").append(WizzyWig.console);$("#wizzywigConsole .save").click(function(b){a.save(b)});c.makeCopyable($("#wizzywigConsole table"))}WizzyWig.editableElements="td, h1, h2, p";WizzyWig.draggableElements="table, h1, h2, p";
WizzyWig.clearDiv='<div class="clear"/>';WizzyWig.saveButton='<button class="save clear left">Save</button>';WizzyWig.helpButton='<button class="help clear left">Help</button>';WizzyWig.simpleConcept='<table id="simpleConcept" class="left"><tr><td class="names">Simple Concept</td><td>x</td><td class="names">does</td><td>y</td></tr></table>';WizzyWig.multiRowConcept='<table class="left"><tr><td class="fixture">MultiRow Concept</td></tr><tr class="names"><td>heading 1</td><td>heading 2</td></tr><tr><td>data 1</td><td>data 2</td></tr></table>';
WizzyWig.console='<div class="middleFixed"><div id="wizzywigConsole"><span id="plus">w</span><div class="left spaced" style="margin-top: 20px; ">'+WizzyWig.saveButton+WizzyWig.helpButton+"</div>"+WizzyWig.simpleConcept+WizzyWig.multiRowConcept+WizzyWig.clearDiv+"</div></div>";WizzyWig.knownBugs="These features are known to misbehave in certain browsers:\n * Input fields don't respond to mouse clicks (Firefox)\n";
